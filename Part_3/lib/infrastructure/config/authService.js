const jwt = require('jsonwebtoken'); const bcrypt = require('bcrypt'); const { JWT_SECRET_KEY } = require('../config');  class AuthService {   constructor(userRepository) {     this.userRepository = userRepository;   }    async login(email, password) {     const user = await this.userRepository.getUserByEmail(email);     if (!user) {       throw new Error('User not found');     }      const passwordMatch = await bcrypt.compare(password, user.password);     if (!passwordMatch) {       throw new Error('Incorrect password');     }      const token = jwt.sign({ userId: user._id }, JWT_SECRET_KEY);     return token;   } }  module.exports = AuthService;